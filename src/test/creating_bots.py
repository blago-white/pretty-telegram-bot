import datetime
import random
import time

from src.bot.db import sqlexecutor
import asyncio

from string import ascii_letters

names = {'Алиса': 'f',
         'Александра': 'f',
         'Алина': 'f',
         'Алла': 'f',
         'Анастасия': 'f',
         'Анжелика': 'f',
         'Анна': 'f',
         'Валентина': 'f',
         'Валерия': 'f',
         'Вера': 'f',
         'Вероника': 'f',
         'Виктория': 'f',
         'Галина': 'f',
         'Дарья': 'f',
         'Диана': 'f',
         'Ева': 'f',
         'Евгения': 'f',
         'Екатерина': 'f',
         'Алёна': 'f',
         'Елена': 'f',
         'Елизавета': 'f',
         'Жанна': 'f',
         'Инна': 'f',
         'Ирина': 'f',
         'Карина': 'f',
         'Кристина': 'f',
         'Ксения': 'f',
         'Лариса': 'f',
         'Любовь': 'f',
         'Людмила': 'f',
         'Маргарита': 'f',
         'Марина': 'f',
         'Мария': 'f',
         'Мила': 'f',
         'Милана': 'f',
         'Надежда': 'f',
         'Наталья': 'f',
         'Ника': 'f',
         'Нина': 'f',
         'Оксана': 'f',
         'Олеся': 'f',
         'Ольга': 'f',
         'Полина': 'f',
         'Руслана': 'f',
         'Сания': 'f',
         'Светлана': 'f',
         'София': 'f',
         'Софья': 'f',
         'Тамара': 'f',
         'Татьяна': 'f',
         'Юлия': 'f',
         'Яна': 'f',
         'Александр': 'm',
         'Алексей': 'm',
         'Анатолий': 'm',
         'Андрей': 'm',
         'Антон': 'm',
         'Аркадий': 'm',
         'Арсений': 'm',
         'Артём': 'm',
         'Артур': 'm',
         'Борис': 'm',
         'Вадим': 'm',
         'Валентин': 'm',
         'Валерий': 'm',
         'Василий': 'm',
         'Виктор': 'm',
         'Виталий': 'm',
         'Владимир': 'm',
         'Владислав': 'm',
         'Вячеслав': 'm',
         'Георгий': 'm',
         'Глеб': 'm',
         'Григорий': 'm',
         'Даниил': 'm',
         'Денис': 'm',
         'Дмитрий': 'm',
         'Евгений': 'm',
         'Егор': 'm',
         'Иван': 'm',
         'Игорь': 'm',
         'Илья': 'm',
         'Кирилл': 'm',
         'Константин': 'm',
         'Лев': 'm',
         'Леонид': 'm',
         'Максим': 'm',
         'Марк': 'm',
         'Матвей': 'm',
         'Михаил': 'm',
         'Никита': 'm',
         'Николай': 'm',
         'Олег': 'm',
         'Павел': 'm',
         'Пётр': 'm',
         'Роман': 'm',
         'Руслан': 'm',
         'Сергей': 'm',
         'Степан': 'm',
         'Тимур': 'm',
         'Фёдор': 'm',
         'Юрий': 'm',
         'Ярослав': 'm'}

lastnames = [
    'Смирнов',
    'Иванов',
    'Кузнецов',
    'Соколов',
    'Попов',
    'Лебедев',
    'Козлов',
    'Новиков',
    'Морозов',
    'Петров',
    'Волков',
    'Соловьёв',
    'Васильев',
    'Зайцев',
    'Павлов',
    'Семёнов',
    'Голубев',
    'Виноградов',
    'Богданов',
    'Воробьёв',
    'Фёдоров',
    'Михайлов',
    'Беляев',
    'Тарасов',
    'Белов',
    'Комаров',
    'Орлов',
    'Киселёв',
    'Макаров',
    'Андреев',
    'Ковалёв',
    'Ильин',
    'Гусев',
    'Титов',
    'Кузьмин',
    'Кудрявцев',
    'Баранов',
    'Куликов',
    'Алексеев',
    'Степанов',
    'Яковлев',
    'Сорокин',
    'Сергеев',
    'Романов',
    'Захаров',
    'Борисов',
    'Королёв',
    'Герасимов',
    'Пономарёв',
    'Григорьев',
    'Лазарев',
    'Медведев',
    'Ершов',
    'Никитин',
    'Соболев',
    'Рябов',
    'Поляков',
    'Цветков',
    'Данилов',
    'Жуков',
    'Фролов',
    'Журавлёв',
    'Николаев',
    'Крылов',
    'Максимов',
    'Сидоров',
    'Осипов',
    'Белоусов',
    'Федотов',
    'Дорофеев',
    'Егоров',
    'Матвеев',
    'Бобров',
    'Дмитриев',
    'Калинин',
    'Анисимов',
    'Петухов',
    'Антонов',
    'Тимофеев',
    'Никифоров',
    'Веселов',
    'Филиппов',
    'Марков',
    'Большаков',
    'Суханов',
    'Миронов',
    'Ширяев',
    'Александров',
    'Коновалов',
    'Шестаков',
    'Казаков',
    'Ефимов',
    'Денисов',
    'Громов',
    'Фомин',
    'Давыдов',
    'Мельников',
    'Щербаков',
    'Блинов',
    'Колесников',
    'Карпов',
    'Афанасьев',
    'Власов',
    'Маслов',
    'Исаков',
    'Тихонов',
    'Аксёнов',
    'Гаврилов',
    'Родионов',
    'Котов',
    'Горбунов',
    'Кудряшов',
    'Быков',
    'Зуев',
    'Третьяков',
    'Савельев',
    'Панов',
    'Рыбаков',
    'Суворов',
    'Абрамов',
    'Воронов',
    'Мухин',
    'Архипов',
    'Трофимов',
    'Мартынов',
    'Емельянов',
    'Горшков',
    'Чернов',
    'Овчинников',
    'Селезнёв',
    'Панфилов',
    'Копылов',
    'Михеев',
    'Галкин',
    'Назаров',
    'Лобанов',
    'Лукин',
    'Беляков',
    'Потапов',
    'Некрасов',
    'Хохлов',
    'Жданов',
    'Наумов',
    'Шилов',
    'Воронцов',
    'Ермаков',
    'Дроздов',
    'Игнатьев',
    'Савин',
    'Логинов',
    'Сафонов',
    'Капустин',
    'Кириллов',
    'Моисеев',
    'Елисеев',
    'Кошелев',
    'Костин',
    'Горбачёв',
    'Орехов',
    'Ефремов',
    'Исаев',
    'Евдокимов',
    'Калашников',
    'Кабанов',
    'Носков',
    'Юдин',
    'Кулагин',
    'Лапин',
    'Прохоров',
    'Нестеров',
    'Харитонов',
    'Агафонов',
    'Муравьёв',
    'Ларионов',
    'Федосеев',
    'Зимин',
    'Пахомов',
    'Шубин',
    'Игнатов',
    'Филатов',
    'Крюков',
    'Рогов',
    'Кулаков',
    'Терентьев',
    'Молчанов',
    'Владимиров',
    'Артемьев',
    'Гурьев',
    'Зиновьев',
    'Гришин',
    'Кононов',
    'Дементьев',
    'Ситников',
    'Симонов',
    'Мишин',
    'Фадеев',
    'Комиссаров',
    'Мамонтов',
    'Носов',
    'Гуляев',
    'Шаров',
    'Устинов',
    'Вишняков',
    'Евсеев',
    'Лаврентьев',
    'Брагин',
    'Константинов',
    'Корнилов',
    'Авдеев',
    'Зыков',
    'Бирюков',
    'Шарапов',
    'Никонов',
    'Щукин',
    'Дьячков',
    'Одинцов',
    'Сазонов',
    'Якушев',
    'Красильников',
    'Гордеев',
    'Самойлов',
    'Князев',
    'Беспалов',
    'Уваров',
    'Шашков',
    'Бобылёв',
    'Доронин',
    'Белозёров',
    'Рожков',
    'Самсонов',
    'Мясников',
    'Лихачёв',
    'Буров',
    'Сысоев',
    'Фомичёв',
    'Русаков',
    'Стрелков',
    'Гущин',
    'Тетерин',
    'Колобов',
    'Субботин',
    'Фокин',
    'Блохин',
    'Селиверстов',
    'Пестов',
    'Кондратьев',
    'Силин',
    'Меркушев',
    'Лыткин',
    'Туров'
]

cyrillic = 'АБВГДЕЖЗИКЛМНОПРСТУФХЦЧШЮЭЯ'


def shuffle_(dict_: dict):
    length = len(dict_)
    keys = list(dict_.keys())

    result_dict = dict()
    len_shuffeled = int()

    for index in range(length):
        k = random.randint(len_shuffeled, length - 1)
        result_dict.update({keys[k]: dict_[keys[k]]})
        len_shuffeled += 1


async def main():
    global names

    conn = sqlexecutor.Execute(...)

    shuffle_(names)
    keys = list(names.keys())

    result_user_names = list()
    result_profiles = list()
    tgid = 0

    for profile_info in range(1000):
        k = random.randint(0, 103 - 1)
        random_name = keys[k]
        result_user_names.append([random_name, f'{random.choice(lastnames)}'
                                               f'{"а" if names[random_name] == "f" else ""}',
                                               names[random_name]
                                  ])

    print(*result_user_names, sep='\n')

    for _ in range(len(result_user_names)):

        tgid += 1
        result_profiles.append([
            tgid,
            random.randint(13, 45),
            bool(random.randint(0, 1)),
            'i am bot'
        ])

    tasks = []

    for idx, profile_info in enumerate(result_profiles):
        random_letter = random.choice(cyrillic)
        random_city = conn.complete_transaction(random_letter, random.randint(1, 10), number_temp=22).object[0]
        print(random_city)
        random_city = random_city[-1]

        conn.complete_transaction(profile_info[0], number_temp=9)
        conn.complete_transaction(profile_info[0],
                                  result_user_names[idx][0],
                                  result_user_names[idx][1],
                                  ''.join([random.choice(list(ascii_letters)) for _ in range(8)]),
                                  datetime.datetime.now(),
                                  number_temp=7)

        conn.complete_transaction('age', profile_info[1], profile_info[0], number_temp=10)
        conn.complete_transaction('city',
                                  f"'{random_city}'",
                                  profile_info[0],
                                  number_temp=10)
        conn.complete_transaction('sex',
                                  True if result_user_names[idx][-1] == 'm' else False,
                                  profile_info[0],
                                  number_temp=10)
        conn.complete_transaction('description', f"'{profile_info[-1]}'", profile_info[0], number_temp=10)

    conn.exit()


if __name__ == '__main__':
    asyncio.run(main())
